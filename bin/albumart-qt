#!/usr/bin/python
# -*- coding: iso-8859-1 -*-
#
# Album Cover Art Downloader
# Copyright (C) 2003, 2004 Sami Kyöstilä <skyostil@kempele.fi>
# 
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 2 of the License, or
# at your option) any later version.

import os
import sys
import qt
import getopt

def getBaseDir():
  path = os.path.dirname(sys.argv[0])
  if os.path.split(path)[-1] == 'bin':
    path = os.path.dirname(path)
  return path

def getLibDir():
  return os.path.join(getBaseDir(), "lib", "albumart")

def getShareDir():
  return os.path.join(getBaseDir(), "share", "albumart")

def printUsage():
  print """\
Assings cover images to directories holding albums.
Usage:
%(app)s      [directory]""" % { "app" : sys.argv[0] }

# find out where our program and data files are and set up sys.path accordingly.
sys.path = [getBaseDir(), getLibDir()] + sys.path

import albumart_ui

if __name__=="__main__":
  try:
    opts, args = getopt.getopt(sys.argv[1:],
                               "h",
                               ["help"])
  except getopt.GetoptError:
    printUsage()
    sys.exit(2)
    
  for option, arg in opts:
    if option in ("-h", "--help"):
      printUsage()
      sys.exit()
      
  if not args:
    args = [None]
  
  app = qt.QApplication(sys.argv)
  mainwin = albumart_ui.AlbumArtUi(dataPath = getShareDir(), albumPath = args[0])
  app.setMainWidget(mainwin)
  mainwin.show()

  try:
    app.exec_loop()
  except:
    traceback.print_exc(file = sys.stdout)
    sys.exit(1)
